import{d as R,a0 as z,h as X,v as B,j as $,a1 as I,o as Y,c as L,k as W,r as O,n as g,O as _,e as x,Q as V}from"./framework.7c2c4810.js";const j={type:{type:String,default:"hover"},minBarSize:{type:Number,default:50},scrollTop:{type:Number,default:0},scrollLeft:{type:Number,default:0},offsetLeft:{type:Number,default:0},offsetRight:{type:Number,default:10},offsetTop:{type:Number,default:0},offsetBottom:{type:Number,default:10},isAutoUpdate:{type:Boolean,default:!0},dragSpeedX:{type:Number,default:1},dragSpeedY:{type:Number,default:1}},N=(n,a,f,e,l)=>(n-a)/(a-f-e-l),A=(n,a,f,e,l)=>{const i=n-(a-n)-f-e;return i<l?l:i},Q={name:"LScrollBar"},J=R({...Q,props:j,emits:["scroll"],setup(n,{expose:a,emit:f}){const e=n,l=z({scrollWidth:0,scrollHeight:0,scrollContentWidth:0,scrollContentHeight:0,scrollBarY:{height:0,top:e.offsetTop,clientY:null,multiple:1,scrollTop:0},scrollBarX:{width:0,left:e.offsetLeft,clientX:null,multiple:1,scrollLeft:0}});let i=!1,T=null,b=null,w=null;const v=X(),s=X(),d=X(),k=()=>{l.scrollWidth=s.value.offsetWidth,l.scrollHeight=s.value.offsetHeight,l.scrollContentWidth=d.value.offsetWidth,l.scrollContentHeight=d.value.offsetHeight},u=()=>{const{scrollContentWidth:t,scrollWidth:o,scrollContentHeight:r,scrollHeight:c}=l;t>o&&(l.scrollBarX.width=A(o,t,e.offsetLeft,e.offsetRight,e.minBarSize),l.scrollBarX.multiple=N(t,o,l.scrollBarX.width,e.offsetLeft,e.offsetRight)),r>c&&(l.scrollBarY.height=A(c,r,e.offsetTop,e.offsetBottom,e.minBarSize),l.scrollBarY.multiple=N(r,c,l.scrollBarY.height,e.offsetTop,e.offsetBottom))};function p(t=!0){const o=s.value.scrollLeft,r=e.offsetLeft+o/l.scrollBarX.multiple,c=v.value.querySelector(".agile-scroll-bar-x");c&&(c.style.transform=`translateX(${r}px)`),t&&(b=requestAnimationFrame(()=>{p()}))}function m(t=!0){const o=s.value.scrollTop,r=e.offsetTop+o/l.scrollBarY.multiple,c=v.value.querySelector(".agile-scroll-bar-y");c&&(c.style.transform=`translateY(${r}px)`),t&&(w=requestAnimationFrame(()=>{m()}))}const y=()=>{k(),e.type!=="hide"&&(u(),V(()=>{p(!1),m(!1)}))},E=t=>{e.type!=="hide"&&(i||(p(),m(),i=!0),clearTimeout(T),T=setTimeout(()=>{cancelAnimationFrame(b),cancelAnimationFrame(w),i=!1},500)),f("scroll",{scrollTop:s.value.scrollTop,scrollLeft:s.value.scrollLeft,scrollWidth:l.scrollWidth,scrollHeight:l.scrollHeight,scrollContentWidth:l.scrollContentWidth,scrollContentHeight:l.scrollContentHeight},t)},C=(t,o)=>{o==="scrollBarX"&&(l.scrollBarX.clientX=t.clientX,l.scrollBarX.scrollLeft=s.value.scrollLeft),o==="scrollBarY"&&(l.scrollBarY.clientY=t.clientY,l.scrollBarY.scrollTop=s.value.scrollTop),window.addEventListener("mousemove",S)};function S(t){const o=l.scrollBarX.clientX,r=l.scrollBarY.clientY;if(o){let c=t.clientX-o;s.value.scrollLeft=l.scrollBarX.scrollLeft+c*(l.scrollBarX.multiple*e.dragSpeedX)}if(r){let c=t.clientY-r;s.value.scrollTop=l.scrollBarY.scrollTop+c*l.scrollBarY.multiple*e.dragSpeedY}}function q(){l.scrollBarX.clientX=null,l.scrollBarY.clientY=null,window.removeEventListener("mousemove",S)}function H(){window.addEventListener("mouseup",q)}function U(){window.removeEventListener("mouseup",H)}function M(t){t>=0&&(s.value.scrollLeft=t)}function D(t){t>=0&&(s.value.scrollTop=t)}let h=null;const F=()=>{let t=null;h=new MutationObserver(()=>{clearTimeout(t),t=setTimeout(()=>{y()},200)}),h.observe(d.value,{attributes:!0,childList:!0,subtree:!0})};return B(()=>e.offsetLeft,()=>{u(),p(!1)}),B(()=>e.offsetRight,()=>{u()}),B(()=>e.offsetTop,()=>{u(),m(!1)}),B(()=>e.offsetBottom,()=>{u()}),$(()=>{y(),H(),e.isAutoUpdate&&F()}),I(()=>{U(),e.isAutoUpdate&&h&&h.disconnect()}),a({updated:y,setScrollLeft:M,setScrollTop:D}),(t,o)=>(Y(),L("div",{ref_key:"scrollBox",ref:v,class:g(["agile-scrollbar",{"not-user-select":l.scrollBarX.clientX||l.scrollBarY.clientY,"scrollbar-hover":e.type==="hover","scrollbar-hide":e.type==="hide"}])},[W("div",{ref_key:"scroll",ref:s,class:g(["agile-scroll",{"scroll-x":l.scrollContentWidth>l.scrollWidth,"scroll-y":l.scrollContentHeight>l.scrollHeight}]),onScroll:E},[W("div",{ref_key:"scrollContent",ref:d,class:"agile-scroll-wrapper"},[O(t.$slots,"default")],512)],34),l.scrollContentWidth>l.scrollWidth?(Y(),L("div",{key:0,class:g(["agile-scroll-bar-x",{act:l.scrollBarX.clientX}]),style:_({width:l.scrollBarX.width+"px"}),onMousedown:o[0]||(o[0]=r=>C(r,"scrollBarX"))},null,38)):x("",!0),l.scrollContentHeight>l.scrollHeight?(Y(),L("div",{key:1,class:g(["agile-scroll-bar-y",{act:l.scrollBarY.clientY}]),style:_({height:l.scrollBarY.height+"px"}),onMousedown:o[1]||(o[1]=r=>C(r,"scrollBarY"))},null,38)):x("",!0)],2))}});export{J as _};
